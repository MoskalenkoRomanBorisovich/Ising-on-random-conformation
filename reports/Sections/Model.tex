\section{Модель}

В данной модели мы рассматриваем ансамбли конформаций: множества конформаций одинаковой длинны $L$, полученные при одинаковых температурах. Мы получаем конформации используя алгоритм SAW.
На каждой из конформаций строится модель Изинга \cite{ising}. В каждой вершине размещается спин, который может принимать одно из двух значений: $+1, -1$.
Гамильтониан данной системы имеет вид
\[H = -J\sum_{\langle i, j\rangle}{\sigma_i\sigma_j} - h\sum_i{\sigma_i} \]

где $i, j$ индексы соседних узлов у, $J$- коэффициент взаимодействия $h$ - воздействие внешнего поля.

Статистическая сумма
\[Z = \sum_{\{\sigma\}} e^{-H(\sigma)\beta}, \beta = \frac{1}{kT}\]
где $\{\sigma\}$ -- множество всех возможных наборов значений спинов. $\beta$ -- обратная температура, данное обозначение будет использоваться далее в тексте.

Намагниченность и энергия каждого состояния считаются по следующим формулам

\[ 
E = -J\sum_{i, j} \sigma_i \sigma_j, 
M = \sum_i \sigma_i
\]

Средняя намагниченность системы

\[
\langle M \rangle = \frac{1}{Z}  \sum_{\{\sigma\}} M e^{-H(\sigma)\beta}
\]

\subsection{Метод Монте-Карло}
Для расчёта модели Изинга используется метод Монте-Карло. Были реализованы версии с односпиновым и кластернным апдейтом \cite{wolf_algorithm}. Код представлен в репозитории github \cite{github}. 

Алгоритм с кластерным апдейтом работает следующим образом. На каждой итерации мы выбираем случайный спин и начиная с него начинаем строить кластер из одинаково направленных спинов, добавляя новые спины в кластер с определённой вероятностью. затем мы меняем значения спинов в кластере на противоположные. В отличие от односпинового апдейта, где есть вероятность, что изменение значения спина не будет принято, в кластерном апдейте новые значения спинов принимаются всегда.
В итоге для измерений используется кластерная версия. Благодаря отказоустойчивости и изменению значения сразу нескольких спинов, она работает значительно быстрее, и быстрее сходится, особенно при низких температурах.

Чтобы вычислить намагниченность, мы сначала случайным образом инициализируем спины, затем делаем некоторое число шагов для отжига модели. Далее на каждом шаге мы замеряем намагниченность, и после выполнения определённого числа шагов, усредняем полученные значения. Так как средняя намагниченность равна 0, имеет смысл рассматривать модуль, квадрат намагниченности.

\[
\langle M^2\rangle = \frac{1}{n} \sum_{\{\sigma\}} \left( \sum_i \sigma_i \right)^2
\]
\[
\langle |M|\rangle = \frac{1}{n} \sum_{\{\sigma\}} \left| \sum_i \sigma_i \right|
\]